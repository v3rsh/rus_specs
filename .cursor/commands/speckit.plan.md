---
description: Выполнить рабочий процесс планирования реализации, используя шаблон плана для генерации артефактов проектирования.
handoffs: 
  - label: Создать задачи
    agent: speckit.tasks
    prompt: Разбить план на задачи
    send: true
  - label: Создать чеклист
    agent: speckit.checklist
    prompt: Создать чеклист для следующей области...
---

## Ввод пользователя

```text
$ARGUMENTS
```

Вы **ДОЛЖНЫ** учитывать ввод пользователя перед продолжением (если он не пустой).

## План

1. **Настройка**: Запустите `.specify/scripts/powershell/setup-plan.ps1 -Json` из корня репозитория и распарсите JSON для FEATURE_SPEC, IMPL_PLAN, SPECS_DIR, BRANCH. Для одинарных кавычек в аргументах типа "I'm Groot" используйте синтаксис экранирования: например, 'I'\''m Groot' (или двойные кавычки, если возможно: "I'm Groot").

2. **Загрузить контекст**: Прочитайте FEATURE_SPEC и `.specify/memory/constitution.md`. Загрузите шаблон IMPL_PLAN (уже скопирован).

3. **Выполнить рабочий процесс плана**: Следуйте структуре в шаблоне IMPL_PLAN для:
   - Заполнения Технического контекста (пометить неизвестное как "ТРЕБУЕТ УТОЧНЕНИЯ")
   - Заполнения раздела Проверки конституции из конституции
   - Оценки шлюзов (ОШИБКА при необоснованных нарушениях)
   - Фаза 0: Сгенерировать research.md (разрешить все ТРЕБУЕТ УТОЧНЕНИЯ)
   - Фаза 1: Сгенерировать data-model.md, contracts/, quickstart.md
   - Фаза 1: Обновить контекст агента, запустив скрипт агента
   - Переоценить Проверку конституции после проектирования

4. **Остановить и отчитаться**: Команда завершается после планирования Фазы 2. Отчет о ветке, пути IMPL_PLAN и сгенерированных артефактах.

## Фазы

### Фаза 0: Структура и исследование

1. **Извлечь неизвестное из Технического контекста** выше:
   - Для каждого ТРЕБУЕТ УТОЧНЕНИЯ → задача исследования
   - Для каждой зависимости → задача лучших практик
   - Для каждой интеграции → задача паттернов

2. **Сгенерировать и отправить агентов исследования**:

   ```text
   For each unknown in Technical Context:
     Task: "Research {unknown} for {feature context}"
   For each technology choice:
     Task: "Find best practices for {tech} in {domain}"
   ```

3. **Консолидировать находки** в `research.md` используя формат:
   - Решение: [что было выбрано]
   - Обоснование: [почему выбрано]
   - Рассмотренные альтернативы: [что еще оценивалось]

**Вывод**: research.md со всеми разрешенными ТРЕБУЕТ УТОЧНЕНИЯ

### Фаза 1: Проектирование и контракты

**Предварительные условия:** `research.md` завершен

1. **Извлечь сущности из спецификации функции** → `data-model.md`:
   - Имя сущности, поля, связи
   - Правила валидации из требований
   - Переходы состояний, если применимо

2. **Сгенерировать контракты API** из функциональных требований:
   - Для каждого действия пользователя → конечная точка
   - Использовать стандартные паттерны REST/GraphQL
   - Вывести схему OpenAPI/GraphQL в `/contracts/`

3. **Обновление контекста агента**:
   - Запустить `.specify/scripts/powershell/update-agent-context.ps1 -AgentType cursor-agent`
   - Эти скрипты определяют, какой AI-агент используется
   - Обновить соответствующий файл контекста агента
   - Добавить только новую технологию из текущего плана
   - Сохранить ручные добавления между маркерами

**Вывод**: data-model.md, /contracts/*, quickstart.md, файл агента

## Ключевые правила

- Использовать абсолютные пути
- ОШИБКА при отказах шлюзов или неразрешенных уточнениях
